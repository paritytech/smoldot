<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Finalized block header, plus tree of authenticated non-finalized block headers."><meta name="keywords" content="rust, rustlang, rust-lang, blocks_tree"><title>smoldot::chain::blocks_tree - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../../../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module blocks_tree</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">chain</a>::<wbr><a class="mod" href="#">blocks_tree</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/smoldot/chain/blocks_tree.rs.html#18-622">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Finalized block header, plus tree of authenticated non-finalized block headers.</p>
<p>This module provides the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> type. This type is a data structure
containing a valid tree of block headers, plus the state necessary to verify new blocks with
the intent to add them to that tree. Each block header additionally holds a user-chosen
opaque data.</p>
<p>The state in the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> consists of:</p>
<ul>
<li>One “latest finalized” block and various information about its ancestors, akin to a
<a href="../chain_information/struct.ChainInformation.html" title="chain_information::ChainInformation"><code>chain_information::ChainInformation</code></a>.</li>
<li>Zero or more blocks that descend from that latest finalized block.</li>
</ul>
<p>The latest finalized block is a block that is guaranteed to never be reverted. While it can
always be set to the genesis block of the chain, it is preferable, in order to reduce
memory utilization, to maintain it to a block that is as high as possible in the chain.</p>
<blockquote>
<p><strong>Note</strong>: While mechanisms such as GrandPa provide a network-wide way to designate a block
as final, the concept of GrandPa-provided finality doesn’t necessarily have to
match the concept of finality in the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a>. For example, an API
user might decide to optimistically assume that the block whose number is
<code>highest_block - 5</code> is automatically finalized, and fall back to rebuilding a new
<a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> if that assumption turns out to not be true. The finalized
block in the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> only represents a block that the
<a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> itself cannot remove, not a block that cannot be removed in
the absolute.</p>
</blockquote>
<p>A block can be added to the chain by calling <a href="struct.NonFinalizedTree.html#method.verify_header" title="NonFinalizedTree::verify_header"><code>NonFinalizedTree::verify_header</code></a> or
<a href="struct.NonFinalizedTree.html#method.verify_body" title="NonFinalizedTree::verify_body"><code>NonFinalizedTree::verify_body</code></a>. As explained in details in
<a href="../../verify/index.html">the <code>verify</code> module</a>, verifying the header only verifies the authenticity of
a block and not its correctness. Verifying both the header and body provides the strongest
guarantee, but requires knowledge of the storage of the block that is parent of the block to
verify.</p>
<blockquote>
<p><strong>Note</strong>: There typically exists two kinds of clients: full and light. Full clients store
the state of the storage, while light clients don’t. For this reason, light
clients can only verify the header of new blocks. Both full and light clients
should wait for a block to be finalized if they want to be certain that it will
forever remain part of the chain.</p>
</blockquote>
<p>Additionally, a <a href="struct.NonFinalizedTree.html#method.verify_justification" title="NonFinalizedTree::verify_justification"><code>NonFinalizedTree::verify_justification</code></a> method is provided in order to
verify the correctness of a <a href="../../finality/justification/index.html">justification</a>.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BlockAccess.html" title="smoldot::chain::blocks_tree::BlockAccess struct">BlockAccess</a></div><div class="item-right docblock-short">Access to a block’s information and hierarchy.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BodyInsert.html" title="smoldot::chain::blocks_tree::BodyInsert struct">BodyInsert</a></div><div class="item-right docblock-short">Holds the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> and allows insert a successfully-verified block into it.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BodyVerifyRuntimeRequired.html" title="smoldot::chain::blocks_tree::BodyVerifyRuntimeRequired struct">BodyVerifyRuntimeRequired</a></div><div class="item-right docblock-short">Verification is pending. In order to continue, a <a href="../../executor/host/struct.HostVmPrototype.html" title="host::HostVmPrototype"><code>host::HostVmPrototype</code></a> of the runtime
of the parent block must be provided.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Config.html" title="smoldot::chain::blocks_tree::Config struct">Config</a></div><div class="item-right docblock-short">Configuration for the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.FinalityApply.html" title="smoldot::chain::blocks_tree::FinalityApply struct">FinalityApply</a></div><div class="item-right docblock-short">Returned by <a href="struct.NonFinalizedTree.html#method.verify_justification" title="NonFinalizedTree::verify_justification"><code>NonFinalizedTree::verify_justification</code></a> and
<a href="struct.NonFinalizedTree.html#method.verify_grandpa_commit_message" title="NonFinalizedTree::verify_grandpa_commit_message"><code>NonFinalizedTree::verify_grandpa_commit_message</code></a> on success.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.HeaderInsert.html" title="smoldot::chain::blocks_tree::HeaderInsert struct">HeaderInsert</a></div><div class="item-right docblock-short">Mutably borrows the <a href="struct.NonFinalizedTree.html" title="NonFinalizedTree"><code>NonFinalizedTree</code></a> and allows insert a successfully-verified block
into it.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.NonFinalizedTree.html" title="smoldot::chain::blocks_tree::NonFinalizedTree struct">NonFinalizedTree</a></div><div class="item-right docblock-short">Holds state about the current state of the chain for the purpose of verifying headers.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RuntimeCompilation.html" title="smoldot::chain::blocks_tree::RuntimeCompilation struct">RuntimeCompilation</a></div><div class="item-right docblock-short">A new runtime must be compiled.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.SetFinalizedBlockIter.html" title="smoldot::chain::blocks_tree::SetFinalizedBlockIter struct">SetFinalizedBlockIter</a></div><div class="item-right docblock-short">Iterator producing the newly-finalized blocks removed from the state when the finalized block
is updated.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.StorageGet.html" title="smoldot::chain::blocks_tree::StorageGet struct">StorageGet</a></div><div class="item-right docblock-short">Loading a storage value is required in order to continue.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.StorageNextKey.html" title="smoldot::chain::blocks_tree::StorageNextKey struct">StorageNextKey</a></div><div class="item-right docblock-short">Fetching the key that follows a given one is required in order to continue.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.StoragePrefixKeys.html" title="smoldot::chain::blocks_tree::StoragePrefixKeys struct">StoragePrefixKeys</a></div><div class="item-right docblock-short">Fetching the list of keys with a given prefix is required in order to continue.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.BodyVerifyError.html" title="smoldot::chain::blocks_tree::BodyVerifyError enum">BodyVerifyError</a></div><div class="item-right docblock-short">Error while verifying a block body.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.BodyVerifyStep1.html" title="smoldot::chain::blocks_tree::BodyVerifyStep1 enum">BodyVerifyStep1</a></div><div class="item-right docblock-short">Block verification, either just finished or still in progress.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.BodyVerifyStep2.html" title="smoldot::chain::blocks_tree::BodyVerifyStep2 enum">BodyVerifyStep2</a></div><div class="item-right docblock-short">Block verification, either just finished or still in progress.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.CommitVerifyError.html" title="smoldot::chain::blocks_tree::CommitVerifyError enum">CommitVerifyError</a></div><div class="item-right docblock-short">Error that can happen when verifying a Grandpa commit.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.FinalityVerifyError.html" title="smoldot::chain::blocks_tree::FinalityVerifyError enum">FinalityVerifyError</a></div><div class="item-right docblock-short">Error that can happen when verifying a proof of finality.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.HeaderVerifyError.html" title="smoldot::chain::blocks_tree::HeaderVerifyError enum">HeaderVerifyError</a></div><div class="item-right docblock-short">Error that can happen when verifying a block header.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.HeaderVerifySuccess.html" title="smoldot::chain::blocks_tree::HeaderVerifySuccess enum">HeaderVerifySuccess</a></div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.JustificationVerifyError.html" title="smoldot::chain::blocks_tree::JustificationVerifyError enum">JustificationVerifyError</a></div><div class="item-right docblock-short">Error that can happen when verifying a justification.</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.SetFinalizedError.html" title="smoldot::chain::blocks_tree::SetFinalizedError enum">SetFinalizedError</a></div><div class="item-right docblock-short">Error that can happen when setting the finalized block.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smoldot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>