<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Module containing everything related to the processing of a single libp2p connection."><meta name="keywords" content="rust, rustlang, rust-lang, connection"><title>smoldot::libp2p::connection - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../../../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module connection</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">libp2p</a>::<wbr><a class="mod" href="#">connection</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/smoldot/libp2p/connection.rs.html#18-86">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Module containing everything related to the processing of a single libp2p connection.</p>
<h2 id="overview"><a href="#overview">Overview</a></h2>
<p>Libp2p connections use TCP sockets provided by the operating system.</p>
<blockquote>
<p><strong>Note</strong>: Explaining the TCP/IP protocol is out of scope of this documentation. See for
example <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">the Wikipedia page</a>
for more information.</p>
</blockquote>
<p>Once a TCP connection has been established, the <em>handshake</em> phase starts. This handshake
is described in details in the documentation <a href="single_stream_handshake/index.html" title="single_stream_handshake"><code>single_stream_handshake</code></a> module.</p>
<p>The handshake consists in negotiating with the remote an encryption layer, thanks to which all
communications are encrypted, and a multiplexing layer, thanks to which the stream of data can
be split into a multitude of <strong>substreams</strong>.</p>
<p>After the handshake is over, the connection is now in the <em>established</em> phase. See the
documentation of the <a href="established/index.html" title="established"><code>established</code></a> module for more details.</p>
<p>Once in the established phase, substreams can be opened either by the local endpoint or by the
remote endpoint. When a substream is opened, a protocol is first negotiated in order to
determine the purpose of this substream. Two kinds of protocols, and therefore two kinds of
substreams, are supported:</p>
<ul>
<li>So-called “request-response” substreams. After the protocol is negotiated, the opening side
sends a single message containing a request, and the other endpoint sends back a single
message containing a response. The substream is then closed.</li>
<li>So-called “notifications” substreams. After the protocol is negotiated, the opening side
sends a single handshake message. The other endpoint must then either immediately close the
substream to reject the handshake, or send back a handshake in order to accept it. After the
handshake is accepted, the opening side can send an unbounded number of individual messages.
Only the opening side is allowed to send messages on any given notifications substream.</li>
</ul>
<p>These two kinds of substreams serve as a base framework. The exact nature of these
request-responses and of these notifications is out of scope of this module.</p>
<h2 id="usage"><a href="#usage">Usage</a></h2>
<p>To connect to a libp2p node, start by establishing a TCP connection with the target. This can
be done either through an outgoing connection or connection incoming from a TCP listening
socket.</p>
<blockquote>
<p><strong>Note</strong>: This module only contains <em>no_std</em>-friendly code, and creating TCP connections
isn’t handled by it.</p>
</blockquote>
<p>After a TCP connection is established, use
<a href="single_stream_handshake/struct.HealthyHandshake.html#method.noise_yamux" title="single_stream_handshake::HealthyHandshake::noise_yamux"><code>single_stream_handshake::HealthyHandshake::noise_yamux</code></a> to initialize the state machine that
needs to be maintained in parallel of the connection. The data sent and received over the
socket must respectively be obtained or injected using
<a href="single_stream_handshake/struct.HealthyHandshake.html#method.read_write" title="single_stream_handshake::HealthyHandshake::read_write"><code>single_stream_handshake::HealthyHandshake::read_write</code></a>. See the <a href="single_stream_handshake/index.html" title="single_stream_handshake"><code>single_stream_handshake</code></a>
module documentation for more details.</p>
<p>Keep in mind that the <a href="single_stream_handshake/index.html" title="single_stream_handshake"><code>single_stream_handshake</code></a> module doesn’t provide any timeout. Users
are strongly encouraged to add one, in order to detect situations where the remote is,
intentionally or not, unresponsive.</p>
<p>After the handshake is successful, use <a href="established/struct.ConnectionPrototype.html#method.into_connection" title="established::ConnectionPrototype::into_connection"><code>established::ConnectionPrototype::into_connection</code></a>
to obtain an <a href="established/struct.SingleStream.html" title="established::SingleStream"><code>established::SingleStream</code></a>. Similar to the handshake, use
<a href="established/struct.SingleStream.html#method.read_write" title="established::SingleStream::read_write"><code>established::SingleStream::read_write</code></a> to update the state machine.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><div class="item-table"><div class="item-row"><div class="item-left import-item" id="reexport.NoiseKey"><code>pub use noise::<a class="struct" href="noise/struct.NoiseKey.html" title="struct smoldot::libp2p::connection::noise::NoiseKey">NoiseKey</a>;</code></div></div><div class="item-row"><div class="item-left import-item" id="reexport.UnsignedNoiseKey"><code>pub use noise::<a class="struct" href="noise/struct.UnsignedNoiseKey.html" title="struct smoldot::libp2p::connection::noise::UnsignedNoiseKey">UnsignedNoiseKey</a>;</code></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="established/index.html" title="smoldot::libp2p::connection::established mod">established</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="multistream_select/index.html" title="smoldot::libp2p::connection::multistream_select mod">multistream_select</a></div><div class="item-right docblock-short">Multistream-select is a protocol whose purpose is to negotiate protocols.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="noise/index.html" title="smoldot::libp2p::connection::noise mod">noise</a></div><div class="item-right docblock-short">Noise protocol libp2p layer.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="single_stream_handshake/index.html" title="smoldot::libp2p::connection::single_stream_handshake mod">single_stream_handshake</a></div><div class="item-right docblock-short">State machine handling the handshake with a TCP or WebSocket libp2p connection.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="yamux/index.html" title="smoldot::libp2p::connection::yamux mod">yamux</a></div><div class="item-right docblock-short">Yamux multiplexing protocol.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smoldot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>