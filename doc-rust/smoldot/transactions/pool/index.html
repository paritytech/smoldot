<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="General-purpose transactions pool."><meta name="keywords" content="rust, rustlang, rust-lang, pool"><title>smoldot::transactions::pool - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../../../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../smoldot/index.html"><div class="logo-container"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Module pool</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Module <a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">transactions</a>::<wbr><a class="mod" href="#">pool</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/smoldot/transactions/pool.rs.html#18-644">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>General-purpose transactions pool.</p>
<p>The transactions pool is a complex data structure that holds a list of pending transactions,
in other words transactions that should later be included in blocks, and a list of
transactions that have been included in non-finalized blocks.</p>
<p>See the <a href="..">parent module’s documentation</a> for an overview of transactions.</p>
<h2 id="overview"><a href="#overview">Overview</a></h2>
<p>The transactions pool stores a list of transactions that the local node desires to include in
blocks, and a list of transactions that have already been included in blocks. Each of these
transactions is either validated or not. A transaction in a block is assumed to always succeed
validation. A validated transaction that isn’t present in any block is a transaction that is
assumed to be includable in a block in the future.</p>
<p>The order in which transactions can be included in a block follows a complex system of
“provided” and “required” tags. A transaction that <em>requires</em> some tags can only be included
after all these tags have been <em>provided</em> by transactions earlier in the chain.</p>
<p>The transactions pool isn’t only about deciding which transactions to include in a block when
authoring, but also about tracking the status of interesting transactions between the moment
they become interesting and the moment the block they are included in becomes finalized. This
is relevant both if the local node can potentially author blocks or not.</p>
<p>The transactions pool tracks the height of the <em>best</em> chain, and only of the best chain. More
precisely, it is aware of the height of the current best block. Forks are tracked.</p>
<h2 id="usage"><a href="#usage">Usage</a></h2>
<p>A <a href="struct.Pool.html" title="Pool"><code>Pool</code></a> is a collection of transactions. Each transaction in the pool exposes three
properties:</p>
<ul>
<li>Whether or not it has been validated, and if yes, the block against which it has been
validated and the characteristics of the transaction (as provided by the runtime): the tags it
provides and requires, its longevity, and its priority. See <a href="../validate">the <code>validate</code> module</a>
for more information.</li>
<li>The height of the block, if any, in which the transaction has been included.</li>
<li>A so-called user data, an opaque field controller by the API user.</li>
</ul>
<p>Use <a href="struct.Pool.html#method.add_unvalidated" title="Pool::add_unvalidated"><code>Pool::add_unvalidated</code></a> to add to the pool a transaction that should be included in a
block at a later point in time.</p>
<p>Use <a href="struct.Pool.html#method.append_block" title="Pool::append_block"><code>Pool::append_block</code></a> and <a href="struct.Pool.html#method.retract_blocks" title="Pool::retract_blocks"><code>Pool::retract_blocks</code></a> when a new block is considered as
best in order to let the <a href="struct.Pool.html" title="Pool"><code>Pool</code></a> track the state of the best block of the chain. The
block bodies that are passed to <a href="struct.Pool.html#method.append_block" title="Pool::append_block"><code>Pool::append_block</code></a> are added to the pool.</p>
<p>Use <a href="struct.Pool.html#method.unvalidated_transactions" title="Pool::unvalidated_transactions"><code>Pool::unvalidated_transactions</code></a> to obtain the list of transactions that should be
validated. Validation should be performed using the <a href="../validate"><code>validate</code></a> module, and
the result reported with <a href="struct.Pool.html#method.set_validation_result" title="Pool::set_validation_result"><code>Pool::set_validation_result</code></a>.</p>
<p>Use <a href="struct.Pool.html#method.remove_included" title="Pool::remove_included"><code>Pool::remove_included</code></a> when a block has been finalized to remove from the pool the
transactions that are present in the finalized block and below.</p>
<h2 id="out-of-scope"><a href="#out-of-scope">Out of scope</a></h2>
<p>The following are examples of things that are related transactions pool to but out of scope of
this data structure:</p>
<ul>
<li>Watching the state of transactions.</li>
<li>Sending transactions to other peers.</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AppendBlock.html" title="smoldot::transactions::pool::AppendBlock struct">AppendBlock</a></div><div class="item-right docblock-short">Wraps around <a href="struct.Pool.html" title="Pool"><code>Pool</code></a> while a new best block is being inserted. See <a href="struct.Pool.html#method.append_block" title="Pool::append_block"><code>Pool::append_block</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Config.html" title="smoldot::transactions::pool::Config struct">Config</a></div><div class="item-right docblock-short">Configuration for <a href="struct.Pool.html#method.new" title="Pool::new"><code>Pool::new</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Pool.html" title="smoldot::transactions::pool::Pool struct">Pool</a></div><div class="item-right docblock-short">Data structure containing transactions. See the module-level documentation for more info.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TransactionId.html" title="smoldot::transactions::pool::TransactionId struct">TransactionId</a></div><div class="item-right docblock-short">Identifier of a transaction stored within the <a href="struct.Pool.html" title="Pool"><code>Pool</code></a>.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Vacant.html" title="smoldot::transactions::pool::Vacant struct">Vacant</a></div><div class="item-right docblock-short">See <a href="enum.AppendBlockTransaction.html#variant.Unknown" title="AppendBlockTransaction::Unknown"><code>AppendBlockTransaction::Unknown</code></a>.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.AppendBlockTransaction.html" title="smoldot::transactions::pool::AppendBlockTransaction enum">AppendBlockTransaction</a></div><div class="item-right docblock-short">See <a href="struct.AppendBlock.html#method.block_transaction" title="AppendBlock::block_transaction"><code>AppendBlock::block_transaction</code></a>.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smoldot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.1 (d5a82bbd2 2023-02-07)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>